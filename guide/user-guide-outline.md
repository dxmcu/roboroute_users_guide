## 一、简介

### 1.1 RoboRoute 简介

RoboRoute 是上海仙知机器人科技有限公司（Seer Robotics，以下简称 仙知）开发的多机器人调度系统。仙知整合 RoboRoute 系统、Roboshop Pro 软件，以及 SRC2000 系列控制器，可针对多种类、多数量移动机器人进行复杂操作与协同配合的场景，提供快速、专业的整厂解决方案，以此提升工厂的整体作业效率。

![img](../pictures/01/clip_image001.png)

 

### 1.2 RoboRoute 主要功能

RoboRoute 系统的核心功能如下：

- **机器人调度**

  - 任务分配

      将业务订单分配给最合适的机器人执行。

  - 路线规划

      为执行业务的机器人规划合理的移动路线。

  - 交通管制

      预防机器人之间发生碰撞。

      解决机器人在运行中的路线冲突。

- **场景编辑**

  配合 Roboshop Pro 软件，编辑机器人的移动路线及节点。

  配置工作站、充电桩信息。

  配置机器人可操作的业务类型、动作类型等。

- **状态监控**

  在系统运行期间，实时监控整场机器人的在线状态、所处位置、行进路线、业务进度等。

  也可聚焦具体的机器人，对其进行持续跟踪。

- **机器人管理**

  管理机器人列表，控制机器人在 RoboRoute 系统中上下线。

  指定机器人前往节点或工作站。

  撤回机器人正在执行的业务。

  在不影响生产运输前提下，自动引导低电量机器人回充电站。

- **业务管理**

  支持可视化地创建业务订单。

  通过执行状态，筛选业务订单列表，并获取订单的详细信息。

  批量撤回业务订单。

- **业务统计**

  统计机器人的累计运行时间、停靠和充电时间，以及整体利用率。

  统计工作站的累计访问时间。

  统计业务订单的分配和执行时间，以及完成情况。

- **交互协议**

  提供简洁的 HTTP 访问协议。通过协议可以：

  创建、查询及撤回业务订单。

  查询机器人的状态，或指定机器人在 RoboRoute 系统中上下线。



### 1.3 RoboRoute 系统框图





## 二、部署环境

### 2.1 RoboRoute 服务器

RoboRoute 的硬件载体选用 联想 ThinkStation P318 工作站，其主要优点有：

- 工作站级主机，满足工厂 7 × 24 小时的不间断生产需求。

- 品牌型号入选节能环保清单，即《[环境标志产品政府采购清单](http://www.ccgp.gov.cn/search/hbqdchaxun.htm)》和《[节能产品政府采购清单](http://www.ccgp.gov.cn/search/jnqdchaxun.htm)》。

RoboRoute 服务器的主要配置：

- CPU：英特尔酷睿Core i7-7700

- RAM：16G DDR4 2133 NECC

- 硬盘：1TB

- 操作系统：Ubuntu 16.04

**请注意：**

**为保证用户权益及系统稳定性，RoboRoute 软件仅在仙知指定的 RoboRoute 服务器上运行。**
 **请勿拆下 RoboRoute 服务器上的授权锁。**



### 2.2 机器人及 RoboShop Pro 软件

加入 RoboRoute 调度序列的机器人，必须满足以下条件：

- 使用仙知 SRC1100 或者 SRC2000 系列机器人主控器。

- 使用含通信功能的电池，能够向 RoboRoute 反馈电量信息。

- 机器人具备自主充电能力。



### 2.3 WIFI 环境

现场无线推荐使用MOXA AWK-3131A无线AP，网络延迟控制在200ms之内，网络环境测试请参考：

<https://www.seer-robotics.com/index.do?detail&id=2c93b6e764c9d7430164cf4c3f6d006e> 



## 三、系统安装

### 3.1 硬件安装

RoboRoute 服务器的主机和显示器均为标准市电电源（AC 220V-50Hz），总峰值用电功率 ≤ 1KW，请合理安排电源，保证可靠接地。

RoboRoute 服务器的主要配件包括：

| 配件清单                               |
| -------------------------------------- |
| Thinkstation P318 主机（含授权锁） × 1 |
| 液晶显示器 × 1                         |
| 键鼠套装 × 1                           |

RoboRoute 服务器应部署在室温环境，10°C~30°C 之间。

RoboRoute 服务器应部署至可以目视、或者视频监控到机器人运行现场的地点。并且在该地点，要求能够使用双绞线，将 RoboRoute 服务器连接到机器人所在的局域网络设备中。



### 3.2 密码和账户

RoboRoute 服务器的初始账户为：RoboRoute，初始密码为：roboroute，请注意密码的大小写。



### 3.3 网络配置

请使用超五类双绞线，将 RoboRoute 服务器主机连接至现场局域网络。

请为 RoboRoute 服务器配置静态 IP，并且注意，该局域网络内，不能有其他设备和服务器存在 IP 冲突。

请注意现场网络的覆盖范围，必须涵盖机器人会抵达的所有角落。



### 3.4 更新

软件更新以官网发布版，或者仙知的通知为准。



## 四、场景元素介绍

### 4.1 节点

节点（Point）是用于逻辑映射场景路线中关键位置的元素，是场景拓扑结构的重要组成部分。在 RoboRoute 操作模式下，机器人总是从场景中的一个节点到另一节点运行。节点分为：地标点和停靠点，其属性如下所述：

![img](../pictures/01/clip_image002.png)



其属性描述如下：


| 属性          | 描述                       | 属性          | 描述                   |
| ------------- | -------------------------- | ------------- | ---------------------- |
| 名称          | 节点的全局唯一 ID          | 类型          | 地标点，或者停靠点     |
| X-轴坐标      | 场景坐标系中 X 轴坐标      | 元属性        | 用户自定义的键值型属性 |
| Y-轴坐标      | 场景坐标系中 Y 轴坐标      | 节点 X 轴坐标 | 视图坐标系中 X 轴坐标  |
| 角度          | 机器人到点角度（暂未启用） | 节点 Y 轴坐标 | 视图坐标系中 Y 轴坐标  |
| 标签 X 轴坐标 | 节点ID X 轴坐标            | 标签 Y 轴坐标 | 节点ID Y 轴坐标        |
| 节点标签角度  | 节点ID 角度                |               |                        |



#### 4.1.1 地标点

在 RoboRoute 中，地标点（Land Mark）是机器人处理业务订单时可能短暂停留的节点，机器人在到达该节点时，执行工作站的操作；或者机器人在行进路线中经过的一系列节点。地标点标识为灰色圆点。

![img](../pictures/01/clip_image002.png)

 

#### 4.1.2 停靠点

停靠点（Park Point）是供业务空闲的机器人停靠和待机的节点。机器人执行完毕当前的业务后，若没有新的业务被分配，会前往附近没有被占用的停靠点，等待新的业务订单。如果机器人的电量低于报警阈值，且此时不存在空闲的充电站，机器人也会前往停靠点，但不再接受新的业务订单。停靠点标识为蓝色圆点。

![img](../pictures/01/clip_image003.png)

 

### 4.2 工作站

工作站（Location）是机器人需要进行业务操作的站点，不可以单独存在，必须使用工作站连接，将工作站和地标点关联起来。工作站限定了机器人在该处的工作内容。其属性包含：

![img](../pictures/01/clip_image004.png)

 

其属性描述如下：

| 属性     | 描述                     | 属性            | 描述                          |
| -------- | ------------------------ | --------------- | ----------------------------- |
| 名称     | 工作站的全局唯一ID       | 标志            | 选择工作站图片区分工作站样式  |
| X-轴坐标 | 场景坐标系中的 X 轴坐标  | 工作站 X 轴坐标 | 视图坐标系中 X 轴坐标         |
| Y-轴坐标 | 场景坐标系中的 Y 轴坐标  | 工作站 Y 轴坐标 | 视图坐标系中 Y 轴坐标         |
| 类型     | 该工作站属于的工作站类型 | 标签 X 轴偏移量 | 视图窗口中工作站ID X 轴偏移量 |
| 方向角   | 暂不使用                 | 标签 Y 轴偏移量 | 视图窗口中工作站ID Y 轴偏移量 |
| 元属性   | 用户自定义的键值型属性   |                 |                               |



**注意：**任何情况下，请勿连接工作站和**停靠点**。工作站（包括充电站）只可连接**地标点**。



#### 4.2.1 工作站的元属性

元属性是一种描述参数的键值对，“键” 和 “值” 都是字符串类型。在 RoboRoute 系统中，大多数场景元素、业务订单都可以包含一个或者多个用户自定义的元属性，用于标识或者向机器人传递参数。

如果工作站的元属性非空，则这些参数将被传递给在此执行操作的机器人。例如，

“TL1” 是属于 “Transfer Location” 类型的工作站，该类型工作站可以进行辊筒运载车和产线的对接，而目前仙知的标准辊筒车可以在左侧或者右侧对接产线传送带。此处允许机器人执行的操作包含 “RollerLoad” 和 “RollerUnload”，这两个操作都需要一个 “direction” 参数。如果工作站 “TL1” 包含 ”键：direction，值：left“ 的元属性，那么此处的对接将全部默认在机器人的左侧进行；而在业务订单中，也不再需要提及在此处进行上料/下料操作时的方向。



### 4.3 工作站连接

工作站连接（Link）是用于将工作站和节点进行关联的工具，其属性包含：

![img](../pictures/01/clip_image005.png)

 

其属性描述如下：

| 属性 | 描述                       | 属性     | 描述                 |
| ---- | -------------------------- | -------- | -------------------- |
| 名称 | 根据起始和终点元素自动生成 | 起始元素 | 地标点或工作站的名称 |
| 动作 | 工作站的操作类型限定       | 终点     | 地标点或工作站的名称 |



如果此处的 “动作” 内容**为空**，则在该处工作站，机器人可以执行工作站类型中定义的**所有操作**。

如果此处的 “动作” 内容**非空**，则在该处工作站，机器人只能执行工作站连接的 “动作” 栏所**限定的操作**。

 

### 4.4 工作站类型

工作站类型（Location Type）是一个工作站的必要组成元素，其主要定义了一组机器人允许执行的操作。其属性包含：

![img](../pictures/01/clip_image006.png)

 

其属性描述如下：

| 属性 | 描述                     | 属性   | 描述                     |
| ---- | ------------------------ | ------ | ------------------------ |
| 名称 | 该工作站类型的全局唯一ID | 动作   | 一组允许机器人执行的操作 |
| 标志 | 用于区分不同工作站样式   | 元属性 | 用户自定义的键值型属性   |

 

### 4.5 路径

路径（Path）是两个节点之间的有向连接线。其主要属性包含: 

![img](../pictures/01/clip_image007.png)

 

其属性描述如下：

| 属性         | 描述                         | 属性         | 描述                     |
| ------------ | ---------------------------- | ------------ | ------------------------ |
| 名称         | 路径的全局唯一ID             | 路径曲线类型 | 直线，或者贝塞尔曲线     |
| 长度         | 路径在场景中的长度           | 曲线控制点   | 只有贝塞尔曲线存在控制点 |
| 路径成本     | 路径在路线规划中的成本系数   | 起始元素     | 路径起点                 |
| 最大正向速度 | 路径上允许的最大正向行走速度 | 终点元素     | 路径终点                 |
| 最大反向速度 | 路径上允许的最大反向行走速度 | 锁定路径     | 锁定路径                 |
| 元属性       | 用户自定义的键值型属性       |              |                          |



 若一条路径因故无法通行，可以在系统运行时勾选“锁定路径”，令机器人规划路线时避开此路径。



#### 4.5.1 直线

由于 RoboRoute Viewer 中的场景视图只表示节点间的有向拓扑关系，并非实际的机器人行进路线，因此大多数情况下，使用直线连接节点即可。



#### 4.5.2 2-Bezier & 3-Bezier

贝塞尔曲线，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝塞尔曲线由线段与控制点组成，控制点是可拖动的点，线段像可伸缩的皮筋，编辑模式下路径工具中的 2-Bezier & 3-Bezier 可以用于画这种矢量曲线。 



### 4.6 机器人

机器人（Robot）是场景中业务订单的执行者，机器人的全局唯一 ID 要在三处保证统一：机器人铭牌上的 ID 标识、Roboshop 中定义的名称、RoboRoute 场景中定义的名称。机器人具有以下属性：

![img](../pictures/01/clip_image008.png)

 

其中，机器人状态如下所述：

| 机器人状态  | 含义                                                         |
| ----------- | ------------------------------------------------------------ |
| UNKNOWN     | 机器人不存在于场景之中                                       |
| UNAVAILABLE | 机器人未释放控制权给 RoboRoute，或机器人连接调度服务器超时等 |
| ERROR       | 机器人故障，或执行任务时出现异常                             |
| IDLE        | 机器人已连接到 RoboRoute，并处于空闲状态                     |
| EXECUTING   | 机器人正在执行业务                                           |
| CHARGING    | 机器人正在充电                                               |



机器人在线状态如下所述：

| 机器人在线状态  | 含义                                                         |
| --------------- | ------------------------------------------------------------ |
| TO_BE_IGNORED   | 机器人处于离线状态                                           |
| TO_BE_NOTICED   | RoboRoute 标识出机器人的位置，但不为机器人分配具体的场景资源 |
| TO_BE_RESPECTED | 机器人获取所处节点的资源，但 RoboRoute 不会对其分配任何业务订单和命令 |
| TO_BE_UTILIZED  | 机器人处于完全在线状态                                       |



机器人业务执行状态如下所述：

| 机器人业务执行状态 | 含义                             |
| ------------------ | -------------------------------- |
| UNAVAILABLE        | 无法执行任何业务订单和任务       |
| IDLE               | 空闲状态                         |
| AWAITING_ORDER     | 机器人在等待业务订单中新的子任务 |
| PROCESSING_ORDER   | 机器人正在执行业务订单中的任务   |


机器人的电量状态如下所述：

| 电量状态级别 | 含义                             |
| ------------ | -------------------------------- |
| GOOD         | 电量高于充足阈值                 |
| DEGRADED     | 电量低于充足阈值，但高于报警阈值 |
| CRITICAL     | 电量低于报警阈值                 |



机器人的属性如下所述：

| 属性             | 描述                       | 属性             | 描述                         |
| ---------------- | -------------------------- | ---------------- | ---------------------------- |
| 名称             | 机器人的全局唯一 ID        | 机器人长度       | 机器人车体长度（暂未使用）   |
| 路线颜色         | 机器人的路径颜色           | 低电量报警阈值   | 低于该值机器人不再接受业务   |
| 电量充足阈值     | 电量高于该值时认为电量充足 | 最大正向速度     | 机器人运行时最大的前进速度   |
| 最大反向速度     | 机器人运行时最大的反向速度 | 剩余电量         | 机器人当前电量               |
| 电量状态         | 当前电量状态级别           | 负载状态         | 机器人是否载重（暂未使用）   |
| 机器人状态       | 机器人状态                 | 在线状态         | 机器人的在线状态             |
| 业务执行状态     | 机器人的业务执行状态       | 当前节点         | 机器人当前所在的节点         |
| 下一节点         | 机器人即将前往的节点       | 精确节点         | 机器人的精确位置（暂未启用） |
| 机器人方向       | 机器人到点方向             | 元属性           | 用户自定义的键值型属性       |
| 当前业务订单     | 当前执行的业务订单名称     | 当前业务订单序列 | 当前执行的业务订单序列名称   |
| 可执行的业务类型 | 机器人能够执行的业务类型   | 自主充电类型     | 机器人自主充电操作类型       |

其中，

- 当机器人的 “电量状态” 为 DEGRADED 时，机器人将在业务空闲时回充电桩充电，但如果被分配了新的业务，充电行为将会被撤回。

  当机器人 “电量状态” 为 CRITICAL 时，机器人将在业务空闲时回充电桩充电。即使存在新的业务，机器人也将在充电至 DEGRADED 后，才接受并执行业务。

- 如果业务订单中指定了业务类型（category），那么机器人必须在 “可执行的业务类型” 中包含订单中的业务类型，才有资格接受该业务订单。

- 当机器人需要进行自主充电时，场景中必须至少存在一个充电工作站，其 operation 中包含该机器人的 “自主充电类型”。



### 4.7 互斥区

互斥区（Block）是一个场景元素的集合，在 RoboRoute 操作模式中，如果机器人占用了互斥区中的任何一个元素，将被视为占用了互斥区的全部元素，RoboRoute 不会派遣其他机器人再进入该互斥区的所属元素中。在 Viewer 中互斥区栏如下图所示。

![img](../pictures/01/clip_image022.png)



在工具栏上点击 “互斥区”（详见 5.4.3 节），然后点击互斥区栏，可见场景中已新建一个互斥区元素。在场景中选择一系列节点、路径元素后，在互斥区名称上单击鼠标右键，选择 “添加选中元素至互斥区”，被选中元素即可被添加到该互斥区。互斥区颜色可以在信息栏的颜色选择器中进行变更。

![img](D:/Workspace/git_project/roboroute_users_guide/pictures/01/clip_image057.png)

 

![img](D:/Workspace/git_project/roboroute_users_guide/pictures/01/clip_image058.png)

 

互斥区的属性如下所述：

| 属性       | 描述                     |
| ---------- | ------------------------ |
| 名称       | 互斥区的全局唯一 ID      |
| 互斥区颜色 | 互斥区在场景中表现的颜色 |
| 互斥区元素 | 互斥区包含的元素         |
| 元属性     | 用户自定义的键值型属性   |



### 4.8 元素组

在 Viewer 编辑模式下，点击工具栏 "新建元素组" 按钮，出现如下对话框。选择需要添加到元素组（Group）中的场景元素，然后单击添加选中元素，可将其添加到元素组中。

![img](../pictures/01/clip_image010.png)

 

元素组信息栏会显示您所添加的元素，如下图：

![img](../pictures/01/clip_image011.png)

 使用元素组，可以方便在大型场景中选取关键元素。



### 4.9 业务订单

4.1节—4.8 节所介绍的场景元素，均是记录在场景文件中的静态元素。业务订单是在 RoboRoute 操作模式下，由业务需求方、或者 RoboRoute 系统自身所生产的，一种场景中的动态元素。业务订单描述了业务需求方希望机器人 “去哪儿，做什么” 等基本问题和相关的基本参数，RoboRoute 接收业务订单，并将其分配给具体的机器人执行。

RoboRoute 在操作模式下，一切逻辑和工作都围绕业务订单进行。

业务订单的组成结构，请参照 11.6 节的链接中，Transport Order，以及 Transport Order State 的具体内容；或者参照 5.4.9 节中的业务订单详细信息。

业务订单的状态周期如下图：

![img](../pictures/01/transportOrder.png)



其中，每个状态的意义如下所述：

| 状态            | 描述                                                         |
| --------------- | ------------------------------------------------------------ |
| RAW             | 原始业务订单。如果长期处于 RAW 状态而无法被激活，说明该订单包含非法元素（不存在于场景中的元素），或者包含其他的错误信息（如 operation 或者 category 错误）。 |
| ACTIVE          | 业务订单已激活。如果长期处于 ACTIVE 状态，可能是由于其所依赖的业务订单尚未执行完成。 |
| UNROUTEABLE     | RoboRoute 无法规划机器人的行进路线。出现此状态时，请检查场景拓扑结构。 |
| DISPATCHABLE    | 业务订单信息无误，路线规划完成，等待系统分配机器人。         |
| BEING_PROCESSED | 业务订单正在被执行。                                         |
| FINISHED        | 业务订单已经执行成功。                                       |
| WITHDRAWN       | 业务订单正在被撤回。                                         |
| FAILED          | 业务订单已经被撤回，并且被标记为失败。                       |



## 五、软件界面及运行模式

### 5.1 启动 RoboRoute

双击桌面上的 StartRoboRoute.bat 文件，会启动 Kernel、Viewer 以及其他系统组件。



### 5.2 关闭 RoboRoute

双击桌面上的 CloseRoboRoute.bat 文件，即可关闭 RoboRoute。



### 5.3 Kernel 功能及布局

#### 5.3.1 Kernel 运行模式

Kernel 是 RoboRoute 系统的核心程序，包含两个运行模式：编辑模式和操作模式。

编辑模式下，Kernel 仅可以使用 Viewer 软件切换或者同步场景；

操作模式下，Kernel 不仅可以使用 Viewer 软件切换或者同步场景，也将以当前载入的场景为基础，开启全部的业务逻辑及访问服务，是 RoboRoute 系统的工作模式。Kernel 启动时的默认模式是操作模式。



#### 5.3.2 菜单栏

Kernel 菜单栏包含两个主要功能：Kernel 和帮助；Kernel 中包含模式切换、新建场景以及退出操作；帮助中是关于软件的版权信息。

![img](../pictures/01/clip_image012.png)

 

#### 5.3.3 关键日志页面

Kernel 关键日志负责记录 Kernel 模式切换或者地图同步相关的信息。

![img](../pictures/01/clip_image013.png)

 

#### 5.3.4 机器人管理页面

机器人管理页面中包含当前场景中的机器人列表。其中，“适配器” 指机器人和 RoboRoute 系统间的通信组件，不可更改，无须关注。勾选 “是否可用？” 复选框，可控制机器人适配器在 Kernel 中的使能状态。

在 RoboRoute 仿真 Kernel （需要仙知特别提供）中，利用下图右侧的“机器人信息”栏，可以在线编辑机器人在场景中的位置和状态。而在真实的 RoboRoute 中，“机器人信息” 栏只显示信息，不支持编辑。

![img](../pictures/01/clip_image014.png)

 

### 5.4 Viewer 功能及布局

Viewer 是 RoboRoute 的可视化客户端，主要提供场景编辑、系统监控、订单管理与机器人控制等功能。

![img](../pictures/01/clip_image015.png)



#### 5.4.1 Viewer 运行模式

与 Kernel 相同，Viewer 的运行模式也分为编辑模式和操作模式：

编辑模式：新建、编辑场景文件，与 Kernel 进行场景同步。场景同步包含两个操作，分别是 “将当前场景同步至 Kernel”，以及 “导入 Kernel 中的场景”。

操作模式：当 Kernel 处于操作模式时，同处于操作模式的 Viewer 具有监控全场业务逻辑和状态、下发及管理业务订单、管控机器人等功能。



#### 5.4.2 菜单栏

Viewer 菜单栏包括文件、编辑、动作、视图、帮助等项目：

文件：

![img](../pictures/01/clip_image016.png)

 

| 功能                | 描述                               |
| ------------------- | ---------------------------------- |
| 新建场景            | 新建一个空白场景                   |
| 导入场景            | 从磁盘中导入 XML 格式场景文件      |
| 保存场景            | 将当前场景保存至磁盘               |
| 场景另存为          | 将当前场景保存至磁盘的另一路径     |
| 导入 Kernel 场景    | 导入当前 Kernel 中的场景           |
| 将场景同步至 Kernel | 将当前视图中的场景同步至 Kernel 中 |
| 派遣所有机器人      | 令场景中的所有机器人处于在线状态   |
| 模式                | 选择编辑模式或者操作模式           |
| 显示场景信息        | 统计并显示各场景元素的数量         |



编辑：

![img](../pictures/01/clip_image017.png)

 

| 功能     | 描述                   |
| -------- | ---------------------- |
| 撤销     | 撤销上一步操作         |
| 重做     | 重做上一步操作         |
| 删除     | 删除选中的元素         |
| 复制     | 复制选中的元素         |
| 粘贴     | 将复制的元素粘贴至此处 |
| 克隆     | 克隆选中的元素         |
| 剪切     | 剪切选中的元素         |
| 全选     | 选中所有元素           |
| 取消全选 | 取消所有元素的选中状态 |



动作：

![img](../pictures/01/clip_image018.png)

 

| 功能                       | 描述                                                   |
| -------------------------- | ------------------------------------------------------ |
| 新建业务订单               | 新建一个业务订单                                       |
| 查找机器人                 | 定位场景中的机器人位置                                 |
| 视图坐标替换为当前场景坐标 | 将节点在视图窗口中的显示坐标，替换为场景坐标系中的坐标 |
| 场景坐标替换为当前视图坐标 | 将节点在场景坐标系中的坐标，替换为当前视图窗口中的坐标 |



视图：

![img](../pictures/01/clip_image019.png)

 

| 功能             | 描述                                   |
| ---------------- | -------------------------------------- |
| 添加背景图片     | 为当前场景添加一张背景图片（暂不使用） |
| 添加场景视图     | 添加一个场景视图窗口                   |
| 添加业务订单视图 | 添加一个业务订单视图窗口               |
| 添加订单序列视图 | 添加一个订单序列视图窗口               |
| 插件             | 选择扩展插件                           |
| 重置窗口布局     | 恢复软件窗口的初始布局                 |

 

#### 5.4.3 工具栏

工具栏中的按钮，包含场景编辑工具、业务动作、排版工具等。本手册只介绍场景编辑工具，如下图所示：

![img](../pictures/01/clip_image020.png)

| 工具       | 图标                                            | 功能                                                         |
| ---------- | ----------------------------------------------- | ------------------------------------------------------------ |
| 选择       | ![img](../pictures/01/select-2.png)             | 选取场景中的元素                                             |
| 拖拽       | ![img](../pictures/01/cursor-opened-hand.png)   | 拖拽场景位于视图窗口中的位置                                 |
| 节点       | ![img](../pictures/01/point-halt-arrow.22.png)  | 添加节点，在下拉选项中包括：地标点：![img](../pictures/01/point-halt-arrow.22.png)，停靠点：![img](../pictures/01/point-park-arrow.22.png) |
| 工作站     | ![img](../pictures/01/location.22.png)          | 添加工作站                                                   |
| 路径       | ![img](../pictures/01/path-direct-arrow.22.png) | 添加路径，在下拉选项中包括：直线：![img](../pictures/01/path-direct-arrow.22.png)，2-Bezier，3-Bezier：![img](../pictures/01/path-bezier-arrow.22.png) |
| 工作站连接 | ![img](../pictures/01/link.22.png)              | 添加工作站和节点的连接                                       |
| 工作站类型 | ![img](../pictures/01/locationType.22.png)      | 添加工作站类型                                               |
| 机器人     | ![img](../pictures/01/car.png)                  | 添加机器人                                                   |
| 互斥区     | ![img](../pictures/01/blockdevice-3.22.png)     | 新建互斥区                                                   |
| 元素组     | ![img](../pictures/01/groups.png)               | 新建元素组                                                   |



#### 5.4.4 场景元素栏

场景元素栏列出了场景元素的树状图，点击单个元素后，可以在元素属性中查看或编辑（编辑，仅限 Viewer 编辑模式）。

![img](../pictures/01/clip_image021.png)



#### 5.4.5 互斥区栏

互斥区的描述请参见本文 4.7 节。如下图，互斥区栏使用树状图表述了互斥区及其所属元素的关系。

![img](../pictures/01/clip_image022.png)



#### 5.4.6 元素组栏

元素组的描述请参见本文 4.8 节。如下图，元素组栏同样使用树状图表述其与所属元素的关系。

![img](../pictures/01/clip_image011.png)



#### 5.4.7 Kernel 信息

类似于 Kernel 的关键日志页面，显示 Kernel 中的关键信息，例如运行模式切换，场景同步等。

![img](../pictures/01/clip_image023.png)



#### 5.4.8 场景视图

场景视图窗口，用于显示场景元素的视图位置及拓扑结构。

请注意，节点和路径在 Viewer 场景视图中的视图位置，不等同于应用现场的真实位置，视图位置只做参考使用；场景的有向拓扑结构，则必须被包含于机器人自身地图（.smap 文件）的拓扑结构中。

在 Viewer 编辑模式中，视图窗口用于绘制场景结构；在 Viewer 操作模式中，视图窗口用于监控机器人运行路线及任务动态。

![img](../pictures/01/clip_image024.png)



 视图工具栏在场景视图窗口底侧左边：

![img](../pictures/01/clip_image025.png)

 其功能如下所述：

| 工具         | 图标                                                 | 描述                         |
| ------------ | ---------------------------------------------------- | ---------------------------- |
| 缩放比例     | 下拉菜单，无图标                                     | 用于选择场景视图的缩放比例   |
| 屏幕自适应   | ![img](../pictures/01/zoom-fit-best-4.png)           | 场景视图自适应屏幕大小       |
| 显示栅格     | ![img](../pictures/01/view-split.png)                | 是否显示背景中的栅格线       |
| 显示标尺     | ![img](../pictures/01/document-page-setup.16x16.png) | 是否显示视图左侧和上方的标尺 |
| 显示标签     | ![img](../pictures/01/comment-add.16.png)            | 是否显示元素的标签           |
| 显示互斥区   | ![img](../pictures/01/block.18x18.png)               | 是否显示互斥区               |
| 显示静态路线 | ![img](../pictures/01/staticRoute.18x18.png)         | 当前系统版本已弃用静态路线   |

 

#### 5.4.9 业务订单视图

业务订单视图显示近期（最长至15天内）全部业务的有效信息，并可根据业务状态对其进行筛选查询。

![img](../pictures/01/clip_image075.png)

其字段含义如下所述：

| 字段           | 释义                                            |
| -------------- | ----------------------------------------------- |
| Name           | 业务订单的全局唯一 ID（由业务请求者提供）       |
| 始发工作站     | 需要机器人前往的第一个工作站                    |
| 终点工作站     | 需要机器人前往的最后一个工作站                  |
| 指定机器人     | 指定机器人，或者由 RoboRoute 系统自动分配机器人 |
| 执行中的机器人 | 正在执行业务订单的机器人                        |
| Status         | 业务订单的状态                                  |
| 序列           | 业务订单所属的业务订单序列（暂不使用）          |

其中，业务订单的 Status 字段如 4.9 中所述。

业务订单工具栏在业务订单视图的左上方，如下图所示，

![img](../pictures/01/clip_image076.png)

| 工具                                  | 图标                                                | 描述                                   |
| ------------------------------------- | --------------------------------------------------- | -------------------------------------- |
| 筛选状态为 RAW 的业务订单             | ![img](../pictures/01/filterRaw.16x16.gif)          | 筛选不符合业务规则，无法调度的业务订单 |
| 筛选状态为 DISPATCHABLE 的业务订单    | ![img](../pictures/01/filterActivated.16x16.gif)    | 筛选等待分配机器人的业务订单           |
| 筛选状态为 BEING_PROCESSED 的业务订单 | ![img](../pictures/01/filterProcessing.16x16.gif)   | 筛选正在执行的业务订单                 |
| 筛选状态为 FINISHED 的业务订单        | ![img](../pictures/01/filterFinished.16x16.gif)     | 筛选已经完成的业务订单                 |
| 筛选状态为 FAILED 的业务订单          | ![img](../pictures/01/filterFailed.16x16.gif)       | 筛选被撤回后的、已标记为失败的业务订单 |
| 撤回业务订单                          | ![img](../pictures/01/table-row-delete-2.16x16.png) | 可以批量撤回列表中选取的业务订单       |



撤回业务订单的具体方法，请参见 8.3 节。

双击业务订单列表的任意一条订单，会弹出对话框显示订单的详细信息。

![img](../pictures/01/clip_image027.png)

 

其中字段含义如下表：

| 字段       | 释义                                           |
| ---------- | ---------------------------------------------- |
| Name       | 业务订单的全局唯一 ID                          |
| 创建       | 业务订单的创建时间                             |
| 完成       | 业务订单的实际完成时间                         |
| 截止时间   | 业务订单的预期截止时间                         |
| 机器人     | 执行该业务订单的机器人                         |
| 非必要订单 | 是否为必须执行至完成的业务订单                 |
| 业务类型   | 订单指定的业务类型                             |
| 拒绝       | 拒绝执行业务的机器人及原因                     |
| 订单子任务 | 每个订单子任务的状态                           |
| 元属性     | 订单或订单子任务的元属性                       |
| 路线       | 订单子任务的路线描述                           |
| 路线成本   | 路线规划时的成本系数                           |
| 订单依赖   | 本业务订单在执行前，必须处于完成状态的业务订单 |

其中，

每个订单子任务，都由一个 “目的地” 和一个 “操作” 构成。“目的地” 可以是工作站或节点；“操作” 可以为空，表现为字符串 “NOP”。

截止时间是一个可以处在过去、现在或者未来的时间点。RoboRoute 根据订单的截止时间来决定业务的优先级，截止时间越早，优先级越高。

特别的，如果一个订单被设置为非必要订单，那么在机器人执行过程中，如果有新的必要订单请求，RoboRoute 系统可能会终止非必要订单的执行。只有 RoboRoute 系统本身会发出非必要订单，例如前往停靠点等；用户的业务订单请求全部默认为必要订单。

如果一个订单包含了具体的业务类型，则该订单只能被包含此业务类型的机器人所执行。



#### 5.4.10 机器人视图

机器人视图窗口，主要显示场景中机器人的概括信息，如实时位置、电量、在线状态及自身状态等。

![img](../pictures/01/clip_image081.png)



机器人的图标以仙知 AMB 无人搬运底盘（Auto Mobile Base，Seer Robotics）为原型，其颜色和意义如下：

| 图标                                         | 释义                 | 图标                                       | 释义                 |
| -------------------------------------------- | -------------------- | ------------------------------------------ | -------------------- |
| ![img](../pictures/01/unloaded_normal.png)   | 空载机器人           | ![img](../pictures/01/loaded_normal.png)   | 负载机器人           |
| ![img](../pictures/01/unloaded_error.png)    | 空载机器人，报警状态 | ![img](../pictures/01/loaded_error.png)    | 负载机器人，报警状态 |
| ![img](../pictures/01/unloaded_charging.png) | 空载机器人，充电状态 | ![img](../pictures/01/loaded_charging.png) | 负载机器人，充电状态 |



机器人视图中的 “在线状态” ，对应 4.6 节中的机器人在线状态：

| 机器人视图的在线状态 | 机器人在线状态                  |
| -------------------- | ------------------------------- |
| 离线                 | TO_BE_IGNORED，或 TO_BE_NOTICED |
| 在线不可用           | TO_BE_RESPECTED                 |
| 在线可用             | TO_BE_UTILIZED                  |

在本视图中，可以针对单台机器人进行操作，具体方法将在第 8 章中介绍。



#### 5.4.11 业务订单序列视图

RoboRoute 保留功能，暂不启用。



## 六、入门操作一：场景编辑

### 6.1 使用 Roboshop Pro 扫描和绘制地图

本章节内容请参见  Roboshop pro 使用手册。



### 6.2 使用 Roboshop Pro 软件导出 RoboRoute 场景文件

使用 Roboshop 软件对场景环境及路线进行编辑后，点击 “导出”，选择 “导出 RoboRoute 地图”。

![img](../pictures/01/clip_image044.png)

 

将出现如下对话框。在 “导出场景” 页面，指定导出的文件路径，点击右下角的 “导出”，可以将 .smap 文件导出为 RoboRoute 的 .xml 场景文件。

如果勾选了左下角的 “加入 block” 复选框，系统会自动检测双向路线（易产生交通死锁）和类双向路线，并将其加入互斥区。

RoboRoute 场景文件包含三个相互独立的部分：场景线路拓扑结构，工作站信息（主要是工作站类型的定义及其操作的描述），机器人信息。通过 Roboshop 导出的场景文件，只包含节点、有向路径等基本的线路拓扑结构。您还需要使用 Viewer 软件，继续添加和完善工作站信息、机器人信息等。

![img](../pictures/01/export_xml.png)



### 6.3 使用 Roboshop Pro 软件融合场景文件

如 6.2 节所述，通过 Roboshop 导出的场景文件，只包含场景的线路拓扑结构。如果在其他场景文件中，存在您需要的工作站信息、或是机器人信息，可以使用 “融合场景” 功能，将不同场景文件中的三类信息组合在一起。

下图的三个路径，第一个是 RoboRoute 场景文件将要导出的路径；

第二个是提取机器人信息的场景文件路径；

第三个是提取工作站信息的场景文件路径。

![img](../pictures/01/6.2.1.png)



### 6.4 使用 Roboshop Pro 软件更新场景文件

对于一个场景文件，如果您在 Roboshop 上对相应的 .smap 文件的线路拓扑信息做了稍许改动，而工作站类型、机器人信息完全没有变化，即可以使用 “更新场景” 的功能，将这些改动更新给 RoboRoute 场景文件。

下图的两个路径，第一个是 RoboRoute 场景文件将要导出的路径；

第二个是原场景文件的路径。

![img](../pictures/01/6.2.2.png)



### 6.5 从磁盘中导入场景

在 Viewer 编辑模式下，选择 文件 -> 导入场景，在弹出的 “打开” 对话框中，可以从磁盘导入场景文件。

![img](../pictures/01/clip_image045.png)

 

### 6.6 添加机器人

在 Viewer 编辑模式下，点击工具栏中的![img](../pictures/01/car.png)可以添加机器人。此时，机器人只会在场景元素栏中显示，而不会在场景视图中显示。

如 4.6 节所述，机器人 “名称” 要求和铭牌上的完全等同。通过设置 “低电量报警阈值”、“电量充足阈值”，可以影响到机器人的充电逻辑。

若后期的业务订单请求中包含指定的 “业务类型” ，而您又希望该机器人有机会被分配此业务，您可以在编辑场景时，在机器人 “可执行的业务类型” 中添加业务订单中的 “业务类型”。

自主充电类型默认为 ”CHARGE“，您可以修改为其他任意字符串。但请注意，在本机器人适配的充电站中，其工作站类型的 “动作” 里，一定要包含和本机器人 ”自主充电类型“ 完全相同的字符串。

![img](../pictures/01/clip_image047.png)

 

### 6.7 添加工作站信息

上文提到，通过 Roboshop 直接导出的 xml 场景文件，不包含具体的工作站信息。默认情况下，首次导出的 xml 场景文件包含三个无任何操作描述的工作站类型，分别是：Charge Location，Transfer Location，和 Working Location。您可以任意添加或删除工作站类型，并且在工作站类型中添加或删除 “动作”（即允许机器人执行的操作，请见 11.4 节）。 

![img](../pictures/01/clip_image049.png)



![img](../pictures/01/clip_image006.png)



### 6.8 保存场景

在 Viewer 编辑模式下，点击 文件 -> 保存场景（或者使用快捷键 Ctrl + S），可将当前场景保存至磁盘。

若点击 文件 -> 场景另存为（或者使用快捷键 Ctrl + Shift + S），可以将场景保存至磁盘另一路径。



### 6.9 场景元素统计

点击 文件 -> 显示场景信息，将显示如下统计信息：

![img](../pictures/01/clip_image050.png)



### 6.10 Viewer 向 Kernel 同步场景

Viewer 编辑模式下的场景，需要同步至 Kernel 才能上线。您可点击 文件 -> 将场景同步至 Kernel（或者使用快捷键 Alt + P）。Viewer 和 Kernel 一般在同一台计算机中运行。在以太网连通的前提下，Viewer 和 Kernel 也可在不同的计算机中运行，但您需要在 Viewer 弹出的对话框中，指定 Kernel 的 IP 地址和端口号（默认为 1099）。

![img](../pictures/01/connect_to_kernel.png)



同步成功后，Kernel 日志中会显示 "Kernel created model XXX"（XXX 为场景名称）。



### 6.11 Viewer 导入 Kernel 当前场景

在 Viewer 编辑模式下，点击 文件 -> 导入 Kernel 场景（或者使用快捷键 Alt + K），可将 Kernel 中的场景导入至 Viewer 中。



### 6.12 Viewer 模式切换

Viewer 启动时的默认运行模式为编辑模式。若需要切换运行模式，可点击 文件 -> 模式 进行，或者使用组合快捷键 Alt + M 或者 Alt + O。

从编辑模式切换至操作模式时：

如果 Kernel 也处于操作模式，Viewer 将自动导入 Kernel 的当前场景，并进入操作模式。

如果 Kernel 处于编辑模式，Viewer 切换至操作模式将没有意义。

![img](D:/Workspace/git_project/roboroute_users_guide/pictures/01/operation_mode.png)



### 6.13 场景编辑规则

#### 6.13.1 主干路线

场景中的主干路线，要求全部使用单向路线。对于足够宽阔的主干道路，建议设计为包含往、反两个方向的单向路线（如城市中常见的主干道路），如下图所示。

![img](../pictures/01/clip_image_main_path.png)

**场景中的主干路线，要求能构成有向的强联通图[1]。**

在主干路线上，任意两个节点间的实际距离，不可小于最小的**安全间距[2]**。

**注[1]：**若在有向图 G 中，如果对于任意两个节点 A 和 B，从 A 节点到 B 节点和从 B 节点到 A 节点都存在路径，则称 G 是强连通图（Strongly Connected Graph）。有向图中的极大强连通子图称做有向图的强连通分量。强连通图具有如下定理：一个有向图 G 是强连通的，当且仅当 G 中有一个回路，它至少包含每个节点一次。  

**注[2]：**若场景中的任意两台机器人（可以是不同类型的），分别被导航至节点 A 和 B 上。两台机器人同时按最小转弯半径进行旋转，在理想状态下（不考虑机器人在水平方向上的累计偏移），若绝对无法发生碰撞，则称距离 AB 为安全间距。



#### 6.13.2 交汇路线

当两条路线发生交汇时，可添加一个交汇节点，如下图所示：

![img](../pictures/01/clip_image054.png)

 对于双车道主干路线的交汇，可参考如下设计：

![img](../pictures/01/clip_image_double_join.png)

若因某些原因，不希望设置交汇点，请参考 6.13.4 节，使用互斥区来避免冲突。



#### 6.13.3 停靠点及工作站

在场景中，可以如下图方式设置工作站或充电站：

![img](../pictures/01/clip_image055.png)

同理，也可以用相同方式设置停靠点：

![img](../pictures/01/clip_image055_2.png)

在一个场景中，停靠点的数量应不小于机器人的数量，以避免机器人因无处停靠而阻塞在主干路线上。



#### 6.13.4 双向路线及互斥区

应用场景中，在无法满足单向路线设计的区域，可以使用有互斥区限制的双向路线。例如连接两个房间的窄通道、拥挤的工作站，以及充电站等。 常见的互斥区示例：

- 连接两个房间的窄通道路线

  ![img](../pictures/01/block2.2.png)

  分析：LM01 至 LM04，以及它们间的双向路线，应全部添加至互斥区中。通道在同一时刻至多有一辆机器人通过。

- 机器人只能通过单一通道进出工作站

  ![img](../pictures/01/block4.png)

  分析：L5 和 L6 两个工作站的进出站路线，分别被添加至两个不同的互斥区中。这种设计导致机器人在工作站上会阻塞主干路线，所以不宜令机器人在此进行长时间的业务操作。

  如果机器人在此工作站不可避免长时间的业务操作（如充电站），但业务逻辑上可以确保该工作站在同一时刻至多请求一辆机器人来访问，则可以不使用互斥区，直接如下设计：

  ![img](../pictures/01/block3.2.png)

- 交汇路线不设置交汇点时

  ![img](../pictures/01/block3.1.png)

  分析：若不希望在交汇路线上设置交汇点，则可以如上图设计，将路径 LM01—LM03 和 LM08—LM04 添加至一个互斥区中。


## 七、入门操作二：机器人配置及操作

本章节默认 RoboRoute 已经加载场景文件，并且运行于操作模式。



### 7.1 使用 Roboshop Pro 软件配置机器人

使用 Roboshop Pro 软件连接机器人，打开 “参数配置”，将 ServerIP 配置为 RoboRoute 服务器的 IP；ServerPort 使用默认值；将 VehicleID 配置为机器人铭牌 ID。最后点击 “永久修改”。

![img](../pictures/01/clip_image061.png)



### 7.2 使用 Roboshop Pro 软件重定位机器人

使用 Roboshop Pro 软件连接机器人，加载与 RoboRoute 场景相对应的 .smap 文件。 此时可能如下图所示：

![img](../pictures/01/clip_image062.png)



机器人的本体颜色为橙色或红色，并且激光形状和地图特征不匹配，置信度很低。这说明机器人当前的定位是不正确的。此时从客观环境判断，机器人应处于红色箭头处。

点击 “重定位” 按钮，鼠标变为蓝色箭头。在上图红色箭头处按住鼠标左键，并按箭头所指方向拖拽鼠标，最后松开鼠标左键。如图：

![标题: fig:](../pictures/01/clip_image065.png)



此时会提示：正在进行重定位。稍等片刻，重定位结束后，Roboshop 会提示：

![标题: fig:](../pictures/01/clip_image067.png)



若机器人的激光形状和地图特征相匹配，点击 “确定”。否则需要点击 “取消”，并且再一次执行重定位，如下图：

![标题: fig:](../pictures/01/clip_image068.png)



**请注意，只有正确地重定位机器人后，才能继续进行后续操作。**



### 7.3 使用 Roboshop Pro 软件释放控制权

首先，**使用 Roboshop Pro 软件将机器人导航至场景中的任意节点。**

当机器人导航任务结束后，在 Roboshop 上点击 “释放控制权”，其按钮图标如下所示。如果调度服务器已正常开启，并且上文提到的机器人相关参数均正确配置，Roboshop 将提示释放控制权成功，并将控制权移交给 RoboRoute。

![img](../pictures/01/clip_image069.png)

 

### 7.4 使能机器人通信适配器

在 Kernel 的机器人管理页面，当前场景的机器人列表中，对目标机器人勾选 “是否可用？” 复选框。

如果机器人释放控制权成功，其状态会变为 IDLE，否则状态将变为 UNAVAILABLE。

如果机器人已被正确导航至线路节点，将在 “位置” 一栏显示出当前所在的节点名；对于没有显示位置的机器人，需要使用 Roboshop Pro 软件回收控制权，将机器人导航至附近的节点上，并重新释放控制权。

![img](D:/Workspace/git_project/roboroute_users_guide/pictures/01/clip_image072.png)



机器人正确释放控制权后，在 Viewer 操作模式下的机器人视图里，会显示机器人的主要信息。

![img](../pictures/01/clip_image070.png)



### 7.5 使用 Roboshop Pro 软件回收控制权 

使用 Roboshop Pro 软件连接机器人，点击 “回收控制权”，Roboshop 将收回机器人的控制权。稍后 Kernel 中该机器人的状态将变为 UNAVAILABLE。

![img](D:/Workspace/git_project/roboroute_users_guide/pictures/01/clip_image071.png)



## 八、入门操作三：Viewer 操作模式

本章节默认的前提条件包括： Kernel 已加载场景文件并处于操作模式，机器人已经释放控制权给 RoboRoute。



### 8.1 派遣机器人

按 6.12 节所述，将 Viewer 切换至操作模式。此时 Viewer 标题栏会显示运行模式，场景名称，以及 Kernel 名称等信息。

![img](D:/Workspace/git_project/roboroute_users_guide/pictures/01/clip_image051.png)



点击 文件 -> 派遣所有机器人（或者使用快捷键 Alt + D），将场景中的所有机器人置为在线状态。您也可以在 Viewer 机器人视图上，对机器人进行逐一操作：右键点击机器人 -> 更改机器人在线状态 -> 将机器人置为在线状态。在线且无业务分配的机器人，将自动前往停靠点或者充电站。

![img](../pictures/01/clip_image097.png)



### 8.2 新建业务订单

Viewer 提供了两种方式新建业务订单。

1. 在机器人视图，右键点击机器人 -> 派遣至节点... / 派遣至工作站... ，可将该机器人直接派往指定的节点，或者指定的工作站并执行操作。详见 8.5.2 节的描述。

   ![img](../pictures/01/clip_image098.png)



2. 在菜单栏点击 动作 -> 新建业务订单... ，打开如下对话框。您可按照业务逻辑编写订单子任务。对话框中的专有词汇解释，请参照 5.4.9 中的描述。

   ![img](../pictures/01/clip_image074.png)

 

另外，您可使用 RoboRoute Kernel 提供的 Web API 接口创建业务订单。我们的 Web API 提供了创建 / 撤回 / 查询业务订单，查询机器人状态等功能，详情请参照 11.6 节的 Web API 文档。



### 8.3 业务订单管理

业务订单管理，主要包含业务订单的查询和撤回等操作。

1. 使用业务订单工具栏中的按钮（参见 5.4.9 节的描述），可以通过 Status 字段，在列表中筛选业务订单。

2. 在列表中选择一个或多个业务订单，点击业务订单工具栏中的 “撤回“ 按钮，可以将订单撤回。

![img](../pictures/01/clip_image077.png)



### 8.4 业务订单序列操作

保留功能，暂不介绍。

### 8.5 机器人操作

本节介绍机器人视图中，针对机器人的右键操作。该右键菜单如下图所示。

![img](../pictures/01/clip_image088.png)



#### 8.5.1 聚焦和跟踪机器人 

在机器人右键菜单中，选择聚焦机器人。此时在场景视图中，该机器人将处于选中状态，如下图所示。此功能用于快速定位到指定机器人的位置。

![img](../pictures/01/clip_image089.png)

 

在机器人右键菜单中，选择跟踪机器人。此时在场景视图中，该机器人将持续被红色圆圈环绕。此功能便于单台机器人的长期行为分析与业务调试。

![img](../pictures/01/clip_image090.png)

 

#### 8.5.2 派遣机器人至节点或工作站

在机器人右键菜单中，选择 派遣至节点...，将弹出如下对话框。在下拉菜单中选择某一节点，点击 "确定"，Kernel 将生成一条业务订单，将机器人派往指定位置。

![img](../pictures/01/clip_image092.png)

  

在机器人右键菜单中，选择 派遣至工作站...，将弹出如下对话框。在下拉菜单中选择某一工作站，并选取其所属的某一操作，点击 "确定"，Kernel 将生成一条业务订单，将机器人派往指定工作站执行操作。

![img](../pictures/01/clip_image093.png)



 #### 8.5.3 撤回机器人正在执行的业务订单

当某机器人正在执行业务时，在该机器人右键菜单中，选择 撤回业务订单，出现下级菜单： 

![img](D:/Workspace/git_project/roboroute_users_guide/pictures/01/clip_image079.png)

 

继续选择任一选项，可以撤回该机器人当前正在执行的业务订单（包括前往停靠点或充电站等业务）。其撤回方式的解释如下：

| 撤回方式         | 释义                                                         |
| ---------------- | ------------------------------------------------------------ |
| 并到达下一节点   | 机器人继续执行已经生成的调度指令，执行完毕后 RoboRoute 将撤回当前业务订单。 |
| 并立即停止机器人 | 机器人将在到达下一个节点后立即停止，同时 RoboRoute 撤回当前执行的订单。 |

 

#### 8.5.4 更改机器人在线状态

在机器人右键菜单中，选择 更改机器人在线状态，出现下级菜单：

![img](../pictures/01/clip_image094.png)

 

继续选择任一选项，可以指定当前机器人的在线状态（详见 4.6 节描述）。该下级菜单选项和机器人在线状态的对应关系如下：

| 菜单选项             | 机器人在线状态  | 机器人视图中的 “在线状态” |
| -------------------- | --------------- | ------------------------- |
| 将机器人置为离线状态 | TO_BE_IGNORED   | 离线                      |
| 仅标记机器人位置     | TO_BE_NOTICED   | 离线                      |
| 仅将机器人载入场景   | TO_BE_RESPECTED | 在线不可用                |
| 将机器人置为在线状态 | TO_BE_UTILIZED  | 在线可用                  |



## 九、典型应用流程

1. 接通电源，启动 RoboRoute 服务器主机，双击桌面上的 StartRoboRoute.bat 文件，启动 RoboRoute。

2. 在 Viewer 中导入场景，并将该场景同步至 Kernel 中，然后将运行模式切换至操作模式。

   ![img](../pictures/01/8.6.2.png)



3. 启动场景中的机器人，并将其逐一导航至线路节点上，释放控制权。在 Kernel 中，勾选需要启用的机器人，或者 右键 -> 全部可用，启用全部机器人。

   ![img](../pictures/01/clip_image014.png)



4. 使用一键派遣所有机器人功能，将机器人在线状态全部置为在线可用。此时，机器人将自动前往充电站或停靠点。

   ![img](../pictures/01/clip_image016.png)



5. 使用 Viewer 或者用户程序，向 RoboRoute 发送业务订单。机器人将开始执行业务，Viewer 中会标识出其行进路线。

   ![img](../pictures/01/8.6.5.png)



6. 当需要关闭 RoboRoute 系统时，请先确认业务请求是否已全部执行完毕，并且不再出现新的业务订单。然后使用 Roboshop 依次回收机器人的控制权。最后双击桌面上的 CloseRoboRoute.bat 文件，结束 RoboRoute 系统进程。



## 十、扩展插件

### 10.1 业务统计

业务统计提供了在系统运行的一段时间内，对机器人、节点、业务订单等元素的初步统计功能。点击 视图 -> 插件 -> 统计，导入 Kernel\log\statistics 目录下的统计文件，可以看到如下图的数据分析列表。

![img](../pictures/01/clip_image095.png)

 

### 10.2 随机订单测试

开发者功能，不推荐使用，此处不做介绍。



## 十一、其他

### 11.1 版权声明

- 本手册会定期进行检查和修正，更新后的内容将出现在新版本中。

- 本手册中的内容或信息如有变更，恕不另行通知。

- 安装、使用产品前请阅读本手册。

- 请保管好本手册，以便随时阅读与参考。

- 本手册所记载的内容，不排除有错误或遗漏的可能性，如对本手册中的内容有疑问，请与我司[联系](mailto:support@seer-robotics.com)。

**Seer Robotics** 和 **仙知** 为上海仙知机器人科技有限公司的注册商标。

上海仙知机器人科技有限公司对本文档内容保留所有权利，请勿重制或分发此文档。

Copyright © 2015 – 2018 Seer Robotics Co.，Ltd.



### 11.2 关键术语中英文对照

| 英文            | 中文           |
| --------------- | -------------- |
| Block           | 互斥区         |
| Category        | 业务类型       |
| Driver Order    | 业务订单子任务 |
| Group           | 元素组         |
| Land Mark       | 地标点         |
| Link            | 工作站连接     |
| Location        | 工作站         |
| Location Type   | 工作站类型     |
| Model           | 场景           |
| Order Sequence  | 订单序列       |
| Park Point      | 停靠点         |
| Path            | 路径           |
| Point           | 节点           |
| Property        | 元属性         |
| Transport Order | 业务订单       |
| Vehicle         | 机器人         |
|                 |                |



### 11.3 常用快捷键

| 操作               | 快捷键          |
| ------------------ | --------------- |
| 新建场景           | Ctrl + N        |
| 导入场景           | Ctrl + L        |
| 保存场景           | Ctrl + S        |
| 场景另存为         | Ctrl + Shift +S |
| 导入Kernel场景     | Alt + K         |
| 将场景同步到Kernel | Alt + P         |
| 派遣所有机器人     | Alt + D         |
| 编辑模式           | Alt + M         |
| 操作模式           | Alt + O         |



### 11.4 目前支持的机器人操作及相关元属性（持续更新）

请注意，所有的键、值都是**字符串类型**数据。

备注中，**required** 指该元属性是操作所必须包含的；

optional 指该元属性是操作可选的；

repeated 指该元属性是操作可选的，且数量 ≥ 1。

| 操作                    | 键            | 值                                   | 备注         |
| ----------------------- | ------------- | ------------------------------------ | ------------ |
| RollerLoad/RollerUnload | direction     | left / right                         | **required** |
| RollerLoad/RollerUnload | recoginze     | true / false                         | optional     |
| JackLoad/JackUnload     | recognize     | true / false                         | **required** |
| ForkLoad/ForkUnload     | end_height    | 高度数据（单位：米）                 | optional     |
| ForkLoad/ForkUnload     | layer         | 0：底层， -1：顶层                   | optional     |
| ForkLoad/ForkUnload     | start_height  | 高度数据（单位：米）                 | optional     |
| ForkLoad/ForkUnload     | recoginze     | true / false                         | optional     |
| SetDO                   | DO的序号      | true / false                         | repeated     |
| Wait                    | duration      | 非负整数（单位：毫秒）               | optional     |
| Wait                    | inverse_angle | true / false                         | optional     |
| WaitKey                 | DI的序号      | true / false。当DI为该值时，等待结束 | **required** |
| WaitKey                 | timeout       | 非负整数（单位：毫秒）               | optional     |
| ArmReset                |               |                                      |              |
| GraspLoad / GraspUnload | from          | 根据具体场景定制                     | **required** |
| GraspLoad / GraspUnload | to            | 根据具体场景定制                     | **required** |
| GraspLoad / GraspUnload | remark        | 根据具体场景定制                     | **required** |
|                         |               |                                      |              |



### 11.5 修订历史

| 文件版本 | 发布时间 | 更新描述 | 软件版本      |
| -------- | -------- | -------- | ------------- |
|          |          |          | RoboRoute_1.0 |



### 11.6 业务订单请求 Web API 链接

https://www.seer-robotics.com/plug-in/RoboRoute/index.html



### 11.7 FAQ 链接

TODO



### 11.8 联系我们

网站: www.seer-robotics.com

地址: 上海市浦东新区金桥镇金领之都7号楼203室

邮箱: contact@seer-robotics.com

技术支持:support@seer-robotics.com

商务合作: zhangsui@seer-robotics.com

技术咨询: yys@seer-robotics.com

电话: 400-061-6660 / 086-021-61112205

